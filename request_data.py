import pandas as pd
DATA_DEFAULT={
"fabrik_list_filter_all_99_com_fabrik_99": "",
"filter": [
"Go",
"Go"
],
"fabrik___filter[list_99_com_fabrik_99][value][0]": "",
"fabrik___filter[list_99_com_fabrik_99][condition][0]": "=",
"fabrik___filter[list_99_com_fabrik_99][join][0]": "AND",
"fabrik___filter[list_99_com_fabrik_99][key][0]": "`vw_profiles`.`assoc`",
"fabrik___filter[list_99_com_fabrik_99][search_type][0]": "normal",
"fabrik___filter[list_99_com_fabrik_99][match][0]": "1",
"fabrik___filter[list_99_com_fabrik_99][full_words_only][0]": "0",
"fabrik___filter[list_99_com_fabrik_99][eval][0]": "0",
"fabrik___filter[list_99_com_fabrik_99][grouped_to_previous][0]": "0",
"fabrik___filter[list_99_com_fabrik_99][hidden][0]": "0",
"fabrik___filter[list_99_com_fabrik_99][elementid][0]": "1232",
"fabrik___filter[list_99_com_fabrik_99][value][1]": "M",
"fabrik___filter[list_99_com_fabrik_99][condition][1]": "=",
"fabrik___filter[list_99_com_fabrik_99][join][1]": "AND",
"fabrik___filter[list_99_com_fabrik_99][key][1]": "`vw_profiles`.`gender`",
"fabrik___filter[list_99_com_fabrik_99][search_type][1]": "normal",
"fabrik___filter[list_99_com_fabrik_99][match][1]": "1",
"fabrik___filter[list_99_com_fabrik_99][full_words_only][1]": "0",
"fabrik___filter[list_99_com_fabrik_99][eval][1]": "0",
"fabrik___filter[list_99_com_fabrik_99][grouped_to_previous][1]": "0",
"fabrik___filter[list_99_com_fabrik_99][hidden][1]": "0",
"fabrik___filter[list_99_com_fabrik_99][elementid][1]": "1233",
"limit99": "1000",
"limitstart99": "0",
"option": "com_fabrik",
"orderdir": "",
"orderby": "",
"view": "list",
"listid": "99",
"listref": [
"99_com_fabrik_99",
"99_com_fabrik_99"
],
"Itemid": [
"266",
"266"
],
"fabrik_referrer": "/index.php?option=com_fabrik&view=list&listid=99&Itemid=266",
"ba4ceba82ad9e2a7fcbba02f01ccec6a": "1",
"format": "raw",
"packageId": "0",
"task": "list.filter",
"fabrik_listplugin_name": "",
"fabrik_listplugin_renderOrder": "",
"fabrik_listplugin_options": "",
"incfilters": "1",
"setListRefFromRequest": "1",
"tmpl": "bootstrap"
}

FEMALEPLAYERSDATA = {
"fabrik_list_filter_all_99_com_fabrik_99": "",
"filter": [
"Go",
"Go"
],
"fabrik___filter[list_99_com_fabrik_99][value][0]": "",
"fabrik___filter[list_99_com_fabrik_99][condition][0]": "=",
"fabrik___filter[list_99_com_fabrik_99][join][0]": "AND",
"fabrik___filter[list_99_com_fabrik_99][key][0]": "`vw_profiles`.`assoc`",
"fabrik___filter[list_99_com_fabrik_99][search_type][0]": "normal",
"fabrik___filter[list_99_com_fabrik_99][match][0]": "1",
"fabrik___filter[list_99_com_fabrik_99][full_words_only][0]": "0",
"fabrik___filter[list_99_com_fabrik_99][eval][0]": "0",
"fabrik___filter[list_99_com_fabrik_99][grouped_to_previous][0]": "0",
"fabrik___filter[list_99_com_fabrik_99][hidden][0]": "0",
"fabrik___filter[list_99_com_fabrik_99][elementid][0]": "1232",
"fabrik___filter[list_99_com_fabrik_99][value][1]": "W",
"fabrik___filter[list_99_com_fabrik_99][condition][1]": "=",
"fabrik___filter[list_99_com_fabrik_99][join][1]": "AND",
"fabrik___filter[list_99_com_fabrik_99][key][1]": "`vw_profiles`.`gender`",
"fabrik___filter[list_99_com_fabrik_99][search_type][1]": "normal",
"fabrik___filter[list_99_com_fabrik_99][match][1]": "1",
"fabrik___filter[list_99_com_fabrik_99][full_words_only][1]": "0",
"fabrik___filter[list_99_com_fabrik_99][eval][1]": "0",
"fabrik___filter[list_99_com_fabrik_99][grouped_to_previous][1]": "0",
"fabrik___filter[list_99_com_fabrik_99][hidden][1]": "0",
"fabrik___filter[list_99_com_fabrik_99][elementid][1]": "1233",
"limit99": "50000",
"limitstart99": "0",
"option": "com_fabrik",
"orderdir": "",
"orderby": "",
"view": "list",
"listid": "99",
"listref": [
"99_com_fabrik_99",
"99_com_fabrik_99"
],
"Itemid": [
"266",
"266"
],
"fabrik_referrer": "/index.php?option=com_fabrik&view=list&listid=99&Itemid=266",
"ba4ceba82ad9e2a7fcbba02f01ccec6a": "1",
"format": "raw",
"packageId": "0",
"task": "list.filter",
"fabrik_listplugin_name": "",
"fabrik_listplugin_renderOrder": "",
"fabrik_listplugin_options": "",
"incfilters": "1",
"setListRefFromRequest": "1",
"tmpl": "bootstrap"
}


HEADERS =  [
{
"name": "Accept",
"value": "text/javascript, text/html, application/xml, text/xml, */*"
},
{
"name": "Accept-Encoding",
"value": "gzip, deflate, br"
},
{
"name": "Accept-Language",
"value": "en-GB,en;q=0.5"
},
{
"name": "Alt-Used",
"value": "results.ittf.link"
},
{
"name": "Connection",
"value": "keep-alive"
},
{
"name": "Content-Length",
"value": "2054"
},
{
"name": "Content-type",
"value": "application/x-www-form-urlencoded; charset=utf-8"
},
{
"name": "Cookie",
"value": "85fda785538371be518fb5b360853ad6=35629585bfd15bd93a66e25dadcc7467"
},
{
"name": "Host",
"value": "results.ittf.link"
},
{
"name": "Origin",
"value": "https://results.ittf.link"
},
{
"name": "Referer",
"value": "https://results.ittf.link/index.php?option=com_fabrik&view=list&listid=99&Itemid=266"
},
{
"name": "Sec-Fetch-Dest",
"value": "empty"
},
{
"name": "Sec-Fetch-Mode",
"value": "cors"
},
{
"name": "Sec-Fetch-Site",
"value": "same-origin"
},
{
"name": "TE",
"value": "trailers"
},
{
"name": "User-Agent",
"value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0"
},
{
"name": "X-Requested-With",
"value": "XMLHttpRequest"
}
]
HEADERS = {k:v for k,v in HEADERS}


DROP_COLUMNS = [
        'vw_profiles___player_id' ,      'vw_profiles___name',
        'vw_profiles___assoc',
       'vw_profiles___gender',
        'vw_profiles___age', 
       'vw_profiles___activity', 
       'vw_profiles___handness', 
       'vw_profiles___style',  'vw_profiles___grip',
        'vw_profiles___Totalmatches',
        'vw_profiles___Totalwins',
        'vw_profiles___Totalloses',
        'vw_profiles___Yearmatches',
        'vw_profiles___Yearwins',
        'vw_profiles___Yearloses',
        'vw_profiles___WTTC',
        'slug', 'fabrik_select',
       'fabrik_view_url', 'fabrik_edit_url', 'fabrik_view', 'fabrik_edit',
       'fabrik_actions', 'vw_profiles___WTTC_raw', 'vw_profiles___dob', 'vw_profiles___dob_raw'
    ]

RENAME_COLUMNS = {
        'vw_profiles___player_id_raw' : 'player_id', 
        'vw_profiles___name_raw' : 'name',
       'vw_profiles___assoc_raw' : 'association',
         'vw_profiles___gender_raw' : 'gender',
         'vw_profiles___age_raw':'age',
       'vw_profiles___activity_raw':'activity',
         'vw_profiles___handness_raw':'handness',
       'vw_profiles___style_raw':'style',
         'vw_profiles___grip_raw':'grip',
       'vw_profiles___Totalmatches_raw':'total_matches',
         'vw_profiles___Totalwins_raw':'total_wins',
       'vw_profiles___Totalloses_raw':'total_losses',
         'vw_profiles___Yearmatches_raw':'year_matches',
       'vw_profiles___Yearwins_raw':'year_wins',
         'vw_profiles___Yearloses_raw':'year_losses',
       'vw_profiles___WTTC_raw' : 'wttc', '__pk_val':'private_key'
    }

STAGE_MAP = {'Main Draw' : 2, 'Qualification': 1, 'Pre. Round': 1, 'Preliminary': 1,
       'Consolation': 3, 'Qualification - 2nd Stage': 1, 'Main Draw - Day 1': 2,
       'Qualification - Division 2': 1, 'Main Draw - Division 2': 2, pd.NA:0,
       'Position matches - Division 1': 2, 'Qualification - Division 1': 1,
       'Position Draw': 2, 'Qualification - Division 3': 1,
       'Main Draw - Division 1': 2, 'Position matches - Division 3': 2,
       'Position matches 69- Division 3':2, 'Main Draw - Division 3':2,
       'Main Draw - Stage 2':2, 'Main Draw - Stage 2 (Bronze Match)':2,
       'Position matches 57-60 - Division 3':2, 'Main Draw C': 2,
       'Main Draw B': 2, 'Position matches - Division 2': 2,
       'Main Draw - Day 2': 2, 'Main Draw A': 2,
       'Main Draw - Stage 2 (5-8th place)': 2,
       'Position matches 61-64 - Division 3': 2, 'MAIN': 2, 'GROUPS': 1,
       'Main Draw - Stage 1': 2, 'MAIN|5|8': 2,
       'Main Draw - Stage 2 (5th place)': 2,
       'Main Draw - Stage 2 (7th place)': 2}

EVENT_TYPE_MAP = {'KO':2, 'Group':1, 'Progressive':3, 'Progressive KO':3, 'GP12':4, pd.NA:0,
       'R32-':6, '8FNL':7, 'QFNL':8, 'RND2':6, 'R64-':5, 'RND1':5, 'FNL-':10, 'SFNL':9,
       'GP05':4, 'GP03':4, 'GP11':4, 'GP01':4, 'GP06':4, 'GP13':4, 'GP08':4, 'GP02':4,
       'GP14':4, 'GP04':4, 'GP10':4, 'GP09':4, 'GP07':4}

EVENT_MAP = {'WS' : 0, 'U21WS': 1, 'WT': 0, 'JGT': 2, 'CGS': 3, 'JGS': 2, 'CGT': 3, 'JGD': 2, 'YOGT': 4,
       'XT': 0, 'WT_U21': 1, 'U21WT': 1, 'U19WT': 2, 'U19WS': 2, 'U17WS': 2, 'CBS': 3, 'MCGS': 5,
       'WD': 0, 'U15WT': 3, 'HGS': 0, 'JBT':2, 'U19GS':2, 'CGD':2, 'U15WS':2, 'MT':0,
       'U13WS':4, 'U11WS':5}

ML_FEATURES = ['fab_matches___yr_raw', 'event', 'stage', 'event_type', 'round', 'kind',
       'seq_raw', 'dsg', 'association_a', 'age_a', 'activity_a',
       'total_matches_a', 'total_wins_a', 'total_losses_a', 'year_matches_a',
       'year_wins_a', 'year_losses_a', 'association_x', 'age_x', 'activity_x',
       'total_matches_x', 'total_wins_x', 'total_losses_x', 'year_matches_x',
       'year_wins_x', 'year_losses_x', 'total_points_a', 'total_points_x']